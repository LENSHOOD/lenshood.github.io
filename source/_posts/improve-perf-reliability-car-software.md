---
title: 如何提升智能座舱软件的性能与可靠性
date: 2023-12-12 23:47:09
tags:
- performance engineering
- reliability engineering
- software quality
categories:
- Software Engineering
---



## 1. 智能座舱性能和可靠性表现不佳

据毕马威发布的《2023智能座舱白皮书-聚焦电动化下半场》中的数据，中国汽车智能座舱市场规模呈逐年扩大之势，2022 到 2026 的 5 年复合增长率超过 17%，预示着这一领域的蓬勃发展。伴随着这一趋势的，是智能座舱软件功能的日益丰富，以及整体智能化程度的显著提升。

{% asset_img 1.png %}

尽管市场规模预测会逐年扩大，但随之而来的是消费者对智能座舱软件的投诉比例逐渐上升的现象。同时，这一趋势的焦点主要集中在智能座舱软件的性能和可靠性方面，揭示出智能化功能不断增加所带来的挑战。

根据车质网 2013 年前三季度的汽车投诉分析报告汇总能够得出，智能座舱（车机）涉及的质量问题占比最高，其中 Q1，Q2，Q3 的投诉故障点 TOP20 中与车机相关的部分（影音系统故障，导航问题，车载互联故障，行车安全辅助系统故障等）分别占据总投诉的 15.89%，10.99% 和 10.56%。

{% asset_img 2.png %}

而进一步查阅具体投诉单，会发现包括死机、黑屏、卡顿、响应慢等的问题非常普遍，这些问题严重影响了用户的驾乘体验，也降低了用户对品牌的信心和认同。

结合智能座舱软件的发展趋势和用户投诉问题后，我们认为性能和可靠性是除了操作易用性以外，最为关键的智能座舱软件使用体验度的影响因素。这两个关键因素不仅直接关系到用户的满意度，也在很大程度上决定了智能座舱软件在市场中的竞争力。

首先，性能的提升是确保智能座舱软件流畅运行的基石。随着功能的不断增加，软件需要更高效的处理器和优化的算法，以保证用户操作的即时响应和系统的高度流畅性。通过采用先进的技术，优化程序代码，以及更合理的资源分配，软件开发者可以有效提升性能水平。

其次，可靠性是确保用户在各种使用场景下都能够信赖智能座舱软件的关键。用户期望在驾驶过程中不受到智能座舱软件的干扰，系统应该稳定运行，避免出现崩溃或死机等问题。

在后文中我们将结合软件研发的最佳实践和智能座舱领域软件的自身特点，探讨如何提升其性能和可靠性。



## 2. 性能和可靠性评估通用准则

“If you can’t measure it, you can’t improve it.”

智能座舱软件系统本身是一类软件，其研发过程也会遵循软件的架构设计、开发和质量验证的常见流程。因此在讨论如何改进之前，我们首先应当明确：如何正确评估软件系统的性能和可靠性？

### 2.1. 软件架构特性模型

Mark Richards 和 Neal Ford 在《软件架构：架构模式、特征及实践指南》中曾这样描述 ”架构特性“：

> 架构师可能会与他人合作确定领域或业务需求，但架构师的一个关键职责是定义、发现和分析软件所必须的、与领域无关的事情：架构特性。

架构特性（Architecture Characteristics）是架构师在设计软件时需要考虑的与领域或业务需求无关的软件特性，如可审计性、性能、安全性、可伸缩性、可靠性等等。在很多时候我们也会称之为非功能性需求（Nonfunctional Requirements）或质量属性（Quality Attributes）。

显然，对于关键的软件架构特性，需要在架构设计之初就纳入整体考量，并且在软件研发的流程中持续进行关注。那么在研发软件系统的时候，都有哪些关键架构特性需要考虑呢？

[ISO/IEC 25010:2011](https://www.iso.org/standard/35733.html) 是由国际标准化组织推行的一套标准（现已更新 2023 版本），它隶属于 ISO 系统与软件质量需求和评估（SQuaRE）体系，定义了一组系统和软件质量模型。该质量模型被广泛应用于描述和评估软件质量，可以很好的指导我们对软件关键架构特征进行建模。ISO 25010 描述的质量模型如下：

{% asset_img 3.png %}

ISO 25010 对软件架构特性（标准中称为质量属性）进行了划分，涵盖了众多方面，如功能性、可靠性、性能效能、可维护性、可移植性等。每个质量属性都是由多个特性组成的，这些特性定义了该质量属性的关键方面。每个特性下还包括多个子特性，更细致地描述了特性的具体维度。可见该质量模型提供了一个全面且通用的框架，以便更好地理解和评估软件的质量。

当然，任何一种软件都有其自身的特点和运行环境，能够满足上述质量模型中所有架构特性的软件比较少见且成本高昂，正如对于一套只有 3 个用户的内部系统，设计弹性伸缩来满足可用性是毫无必要的。

回到本文的关注重点，对于性能特性，该模型划分了三种子特性：时间特性，资源利用性，容量；而对于可靠性特性，模型划分了四种子特性：成熟性，可用性，容错性和易恢复性。那么显然在智能座舱软件的领域，以用户体验来评估性能和可靠性特性，比用吞吐量和弹性伸缩比来评估更符合智能座舱软件的设计目标。

### 2.2. 通过指标集评估架构特性

分析前述的软件质量模型，我们会发现该模型主要定义了软件的架构特性 “应当表现为什么样子“，但没有讲明为了达成这些架构特性 “需要怎么做“。即质量模型中的特性和子特性是对架构特性的定性描述，而未能提到如何对架构特性进行定量评估。

事实上，SQuaRE 也提供了对质量模型的评估框架（详见 [ISO/IEC 25020:2019](https://www.iso.org/standard/72117.html)）：

{% asset_img 4.png %}

以上评估框架本质上就是采用一组权重不同的指标集来评估一项架构特性（子特性），指标可以由一些指标元素计算得出，而指标元素可通过一些实施在软件研发活动中的测量方法测量而得。

同样的，根据软件功能领域和运行环境的不同，用于评估架构特性的指标体系也会存在差异。通常，在软件研发过程中已经存在一批跨领域达成共识的指标，如代码圈复杂度、模块耦合度、响应时间、吞吐量、RTO、RPO、MTTR 等等，企业在建立自己业务领域的指标体系时可以直接采纳。

如下就是一组面向软件系统的通用性能和可靠性指标体系示例：

{% asset_img 5.png %}

但对于有鲜明领域特点的架构特性的评估 --- 如通过屏幕操作是否存在卡顿来评估智能座舱性能 --- 则需要结合实际业务场景来选定指标集。事实上，为了最大限度匹配自身独特的需求，智能座舱的研发组织有必要维护一套最适合其业务优势和研发模式的建模和评估体系。



## 3. 持续改进性能和可靠性的工程化方法

基于前文所引入的通用准则，我们已经明确了改善智能座舱软件的性能和可靠性的方向，并且掌握了通用的评估方法。

本节简要讨论的是如何以工程化方法对智能座舱软件的性能和可靠性架构特性进行持续看护和改进，从而确保随着软件的迭代，其性能和可靠性不会逐渐劣化，而是长期、稳步提升。

### 3.1 建立指标评估体系

在前面的介绍性内容中，我们明确了对性能和可靠性架构特性的建模和评估框架，即通过特性和子特性定义模型，之后通过定义指标集建立评估体系，最后通过实测指标值进行验证。

**GQM 方法是一种有效的帮助企业寻找和建立指标体系的分析方法：**

GQM 即 ”Goal - Question - Metrics“，可译为”目标 - 问题 - 指标“ 法，是一种历史悠久的分析方法，[由 Victor Basili 和 David Weiss 在 1984 年提出](https://ieeexplore.ieee.org/document/5010301)。

本质上 GQM 是通过树形分析结构，层层递进的将一个目标拆解为多个问题，再将每个问题拆解为多个支撑指标的分析方法。

以提升智能座舱软件的可靠性特征为例，经过分析我们能够得到如下的 GQM 树：

{% asset_img 6.png %}

之后就可以对第三层的指标开展进一步的分析。在分析之初，GQM 树包含了相对较多的指标，然而许多指标可能既难以准确收集，又没有太大的价值，因此最好是对指标进行优先级排序，筛选最有价值的指标。这一过程可遵循如下排序原则：

- 越容易收集和计算的指标越靠前
- 能支撑越多问题的指标越靠前

基于通过 GQM 方法，我们对模糊的架构特征进行了拆解，得到了更为清晰的指标集，之后就可以开展评估了。



### 3.2 架构适应度函数

建立了指标体系后，我们已经可以定量的对智能座舱软件的性能和可靠性进行分析和评估。然而，如果评估的过程过于复杂、冗长且难以快速进行，那么随着时间的推移，对这些架构特性的评估就会成为团队沉重的负担，这意味着评估活动的次数会越来越少，反馈越来越慢，难以持续且最终停滞下来。

一切可以被自动化的事情，都应该被自动化。

在评估软件功能是否满足要求时，我们会构建大量的自动化测试，这样就能形成对软件需求的安全网并且持续的保障软件符合要求。而对于架构特性的评估，传统意义上会基于各类会议、评审、文档来确保设计的正确性并且可追溯，ASPICE 就是一个典型的案例，流程和文档非常复杂，而在设计定型之后的更新更慢。

{% asset_img 7.png %}

然而由于人的惰性，以及永远也做不完的新需求，在没有持续追踪和验证的情况下，架构会随着软件的迭代而迅速腐化，等到下一次架构评审的时候，架构师手中的蓝图可能早已与现实的软件差之千里了。

Xxx 在《演进式架构》中提出了架构适应度函数的概念，通过适应度函数实现对架构的评估也能自动化、常态化。

{% asset_img 8.png %}

如此，我们就可以将建立的指标体系转换为一个个的适应度函数，它们能够绑定在研发流水线上，从而实现对性能和可靠性架构特性的自动化评估：



### 3.3 持续改进

通过指标体系和适应度函数相互组合，我们能够围绕评估模型，对性能和可靠性进行持续的评估和改进。基于此，我们可以在智能座舱软件的设计、开发和运营阶段引入诸如以下的多种实践，从而进一步提升工程化的效率和水平。

**建模**

建模是在设计阶段对架构特征进行分析的有效实践。建立性能和可靠性模型，能够指导后续研发过程中代码逻辑和测试用例的实现。

对于性能建模，可以通过识别软件架构的性能关注点，以及预定义性能指标来形成性能模型。对于可靠性建模，可参考成熟的建模方法如故障树分析（FTA）以及故障模式和影响分析（FMEA）等。

基于建立的性能和可靠性模型，同样可以构建对应的适应度函数来守护，最常见的适应度函数就是基于性能关注点和指标建立的性能测试用例，以及对识别到的失效模式建立的故障测试用例。

**看护**

自动化是持续改进的前提，看护则是持续改进的驱动因素。基于已经建立的各类适应度函数，在每日构建、迭代测试以及集成测试等各类流程中，适应度函数产生的执行结果能够形成一组完整的性能和可靠性评估报告。

取某一版本的软件作为基线，通过上述过程可以对软件在性能和可靠性上的状态进行看护，从而判断新的版本哪些部分进行了优化，哪些部分产生了劣化，通过基线对比看护，就能驱动软件持续演进。

**定界**



以上关于建模、看护和定界的内容，在我们先前的文章《性能工程实践》中有更详细的介绍说明。



## 总结





## Reference

- [《2023智能座舱白皮书-聚焦电动化下半场》，毕马威](https://kpmg.com/cn/zh/home/insights/2023/04/focus-on-the-second-half-of-electrification-smart-cabin-white-paper.html)
- [《2023年一季度汽车投诉分析报告》，车质网](https://www.12365auto.com/dcbg/20230407/501767-all.shtml#p2)
- [《2023年二季度汽车投诉分析报告》，车质网](https://www.12365auto.com/dcbg/20230706/507909-all.shtml#p2)
- [《2023年三季度汽车投诉分析报告》，车质网](https://www.12365auto.com/dcbg/20231010/514044-all.shtml#p2)
- [《软件架构：架构模式、特征及实践指南》，Mark Richards / Neal Ford](https://book.douban.com/subject/35487561/)
- [SQuaRE 系统与软件质量模型：ISO/IEC 25010:2011，国际标准](https://www.iso.org/standard/35733.html)
- [SQuaRE 质量测量框架：ISO/IEC 25020:2019，国家标准](https://www.iso.org/standard/72117.html)
- [GQM 分析法，Victor Basili 和 David Weiss](https://ieeexplore.ieee.org/document/5010301)



1. 智能座舱软件系统发展过程中的性能和可靠性问题
   1. 功能越复杂，性能越差，可靠性越难以保证
   2. 黑猫投诉排名
   3. 性能和可靠性是除了操作逻辑本身外最关键的体验影响因素
2. 性能和可靠性评估的通用准则
   1. 导入：领域与架构特征
   2. ISO25010 描述的系统与软件质量属性
      1. 质量模型-特性-子特性
      2. 测量和评估方法
3. 智能座舱软件系统的性能和可靠性评估
   1. 评估质量属性的通用指标
      1. 内部测度
         1. 代码本身：复杂度，依赖度，债务指数，变更频率
         2. 失效模式
      2. 外部测度
         1. 响应时间、吞吐量
         2. 故障数
   2. 智能座舱领域常见指标
      1. 性能
         1. 开机时间
         2. 启动时间
         3. 导航速度
         4. 响应速度
         5. 掉帧率
      2. 可靠性
         1. crash
         2. 黑屏
         3. 内存泄漏
4. 用工程化方法评估架构特征
   1. 要求
      1. 常态化
         1. 自动化
         2. 流程化
      2. 质量内建
         1. 左移
   2. 采用适应度函数提升工程化成功率
      1. 自动化
         1. ASPICE 文档自动化
         2. 指标自动化
      2. 适应度函数金字塔
   3. 性能工程
   4. 可靠性工程
      1. FMEA
