---
title: 什么是性能工程？
date: 2023-07-05 22:35:10
tags:
- performance engineering
- performance optimization
- performance analysis
categories:
- Software Engineering
---





性能工程，是指通过设计、构建工具链和工作流从而实现标准化、规模化的持续改善并守护系统性能的一类手段和实践。

本文将从起源开始探寻性能工程出现的必然性，并讨论性能工程的目标，以及企业实践性能工程的演进路径和成熟度模型。



## 起源

近 30 年的互联网大爆炸，让各类传统业务领域通过数字化迅速在互联网蓝海中占领自己的位置，从而实现了业绩高增长和投资高回报。

大量投资推动了计算机技术的极大发展，也反过来影响了在线业务的企业：只要乘着技术发展的东风，就能让单位服务的成本越来越低，而速度却越来越快。

无论是通过调研数据还是从业者自身的感受，我们都会发现，性能是在整个研发流程中被不断后置的。架构设计优先考虑功能，代码研发也是主要关心业务，测试环节除了点点点，留给性能测试的时间少得可怜，还经常遇到人力不足，“先上线再说”。

然而，这种性能后置，甚至无需考虑性能的时代可能即将落幕了。原因有三：

**1. 计算机体系结构发展放缓**

{% asset_img 1.png %}

上图展示了处理器性能在近 40 年间的发展趋势。1986 年开始到 2003 年这段时间，处理器性能每年增加 52%，17 年性能翻了 25 倍。然而由于登纳德缩放比例定律的终结，单核性能无法再增长，导致 2003 年开始性能增长的方向从单核转向了多核，性能增速大幅降低。随着摩尔定律的逐渐失效，2015 年后性能增速仅剩 3.5% 一年。

实际上，在单核处理器主流的年代，处理器通过指令级并行提升性能，这对软件开发完全无感。而在多核时代到来后，主要通过数据级并行（例如 SIMD）和线程级并行（多任务）来提升性能，这对程序员提出了更高的要求。

总之，如果不发生大的技术变革， 软件性能再也无法简单的通过硬件的更新而大幅增长了。

**2. 复杂系统度性能治理愈发困难**

与硬件不同，得益于高度灵活的架构，软件一直朝着扩大规模的方向发展。从早年的单体应用到 SOA 架构，再到分布式、微服务架构和云原生技术等，如今的软件系统规模越来越大，越来越复杂。

{% asset_img 2.png %}

现如今谈论性能早已不再是单个函数的调用，而是跨进程调用甚至远程调用。正如上图所示的[Uber 的微服务架构图](https://www.uber.com/en-HK/blog/microservice-architecture/)，复杂的调用链路上任何一个环节都有可能存在性能瓶颈。系统间依赖的复杂度越高，出现性能阻塞点的概率就越大，如果不加以治理，其结果就是运行低效和无法扩展。

**3. 无法忽视的成本增速**

从虚拟化技术到公有云，再到云原生技术，“提升资源利用率” 一直伴随着软件行业的发展。

![](https://ask.qcloudimg.com/http-save/yehe-5426717/493d47be710d65555a8c5b5888579da8.png?imageView2/2/w/1200)

然而如上图数据显示，虽然企业期望通过提升资源利用率来降低成本，然而上云、云原生改造后，成本却仍也在不断飙升。这与前面提到的系统愈发复杂，规模越来越大有很大关系，毕竟简单的系统更易于理解和治理，而增加一项依赖所导致的复杂度可能是指数级上升的。因此除了提升资源利用率，软件性能也会明显的影响系统成本。

通过对系统进行更深层次的观测，发现性能劣化问题和性能阻塞点进而优化性能，能够在提供同样服务水平的前提下降低硬件开销，充分利用硬件算力，并改善用户体验，从而在多个角度降低成本。



## 问题和挑战

1. 设计研发阶段忽视性能
2. 依赖专家经验
3. 别再给 dev 添加认知负载



## 性能工程目标

1. 性能分析更简单
2. 因性能问题导致的损失更少
3. 规模化性能优化经验



## 成熟度演进

1. 系统化
2. 数据化
3. 知识化
4. 资产化
5. 常态化



## 如何开始？

构建有业务特色的性能工程体系
