---
title: 从成熟度模型看可观测性能力建设
date: 2022-12-17 20:15:53
tags: 
- observability
- maturity model
- monitoring
- capability
categories:
- Software Engineering
---

## 运维挑战与可观测性

### 企业运维的挑战



### 可观测性趋势



## 可观测性成熟度模型

虽然从前文的描述看，企业可观测性能力的建设是持续深入的过程，但如何才能衡量现状，发现不足和指导方向呢？

StackState 作为一家提供可观测性解决方案的咨询公司，发布了一份 《可观测性成熟度模型》，基于其对真实问题、客户讨论以及技术研究，旨在帮助企业在可观察性能力建设上作为指导。

### 成熟度等级

《可观测性成熟度模型》将可观测性分为四个等级，从低到高，越高的等级代表越能深入的对系统进行观测洞察。

#### Level 1：监控

监控代表了相对古老而简单的观测手段：跟踪数值。

跟踪的数值通常专注于基本的组件、应用层面的参数指标，如可用性、性能、容量指标等等。每一次对指标的采集将产生一个事件，时间结合某些阈值，则可能引发报警。

作为最初级的可观测性，通过跟踪数值和指标报警的能力，企业能够获悉组件或应用的健康状态，并在出现故障后得到通知。然而，跟踪数值加报警的形式，的确能告诉运维人员组件除了故障，但故障的原因是什么，需要联系谁来解决该等等问题，都无法在这一级别很好的处理。

此外，随着时间的推移，越来越多的指标项被加入监控系统，结果有可能一个问题会导致一连串的指标报警，从而出现“到处亮红灯，但不知道发生了什么” 的窘境。

#### Level 2：可观测性

可观测性是可观测性成熟度模型的第二个等级（名字的确起得差强人意）。由于上一级别遗留的问题，即只知道出了故障但难以得知故障产生的具体原因。因此第二级的目标就是能确定系统不工作的原因。

第二级可观测性，通常可以采用 “指标”、“日志”、“跟踪” 这三种关键类型的遥测数据来提供系统洞察力。“指标” 与上一级的跟踪数值基本一致。“日志”是对系统中发生事件的带时间戳的记录。”跟踪“则能显示数据是如何从头至尾流经系统的。

实际上，我们会发现这三种关键数据（某些文章称之为三大支柱）已经广泛的应用在了成熟的微服务系统中，围绕着“三大支柱”的各种解决方案也层出不穷。总之，通过合理的方案采集这些遥测数据，并展示在仪表板上，就实现了第二级的可观测能力。

诚然，借助”三大支柱“的有力支持，第二级可观测能力能够更广泛而全面的了解整个系统的运行状态。但随着系统规模的扩大，遥测数据会越来越多，不同的遥测数据也可能会存在于不同的系统中（数据孤岛）。那么当出现问题时就需要通过人工从大量遥测数据中抽丝剥茧，关联因果关系。随着规模的扩大，受限于人力排查，MTTR 的时间也会不断延长。

#### Level 3：因果可观测性

通过人工建立数据相关性，低效且不直观。因果可观察性，作为第三个级别，能够通过某些手段揭示这种相关性，从而达到找到事件发生的原因且确定其对整个系统的影响的目的。

具体通过何种手段建立相关性，将在下一节描述。那么如果实现了因果可观测性能力，可能会遇到的新的挑战可能是什么？

如何对数据规范化，如何长期存储并高效使用这些数据可能会是带来的挑战。另外，巨大的数据量也可能会导致即使揭示了数据的相关性，但仍然需要耗费大量时间来从噪音中分离出有用的信号。

#### Level 4：使用 AIOps 的主动式可观测性

通过 AI 和 ML 的方式从堆积如山的数据中寻找模式，从而能帮助团队更快的发现问题。在指标报警和警告中找到模式的变化，可以帮助团队提前预知可能发生的故障，进而实现预防性的、无事故的运维目标。

AIOps 能够提升效率，提高根因分析的准确率，甚至预测异常和实现系统自愈。

### 因果可观测性

从前面可观测性的四个成熟度等级可以发现，实现了”三大支柱“的第二个级别，得益于技术的成熟，是目前多数系统能够达到或是已经处于的位置。而更进一步，达到因果可观测性，则是相对清晰的发展方向。那么，如何实现因果可观测性的目标，建立数据之间的相关性呢？

《可观测性成熟度模型》中给出的方法，是建立**时间序列下的拓扑结构变化视图**。

对系统进行故障根因调查时，先看看系统 ”发生了哪些变化“，是相对合理的切入点。毕竟大多数故障都是因系统发生了变更而引起的，比如新的代码部署、配置变更、自动扩缩容等等。

但复杂的系统可能会发生不止一处变化，如果能对比故障发生前后，整个系统栈的拓扑结构变化以及组件之间的关系变化，就能清晰的辨别出变化点及其之间的关系。

拓扑结构是系统内所有组件的地图，它跨越了所有层次，是离散组件之间关系和依赖的集合。

> 现代环境由许多动态层、微服务、无服务器应用和网络技术组成，因此在你的可观察性组合中加入最新的拓扑结构，对于区分因果关系至关重要。拓扑结构为数以千计的未连接的数据流提供了锚点，使它们具有结构性，使以前看不见的连接变得可见。拓扑可视化让你在全栈活动的背景下查看来自网络、基础设施、应用程序和其他领域的遥测数据；它还为你提供了重要的背景，让你知道当某些事情发生时，你的业务是如何受到影响的。
>
> --《可观测性成熟度模型》

![](https://lenshood.github.io/2022/11/27/the-observability-maturity-model/figure2.png)

如上图所示，将原本孤立的数据比如服务的注册发现、自动化部署、请求追踪等等数据汇聚，形成完整的拓扑结构，那么第一级与第二级已经实现收集的各种遥测数据就都可以挂载在拓扑图上。

此外，单有拓扑图还不够。对实施自动化运维的现代系统环境中，频繁的发布、不断变化的基础设施以及动态扩缩容使得拓扑结构变化的很快，处理问题时刻的系统拓扑，可能已经与发生问题时完全不同了。

因此，除了构建拓扑结构来关联数据，留存基于时间的快照也非常关键。一旦拥有了随时间变化的拓扑结构快照，就可以在时间线上自由的对比拓扑的变化并查看对应的遥测数据。

![](https://lenshood.github.io/2022/11/27/the-observability-maturity-model/figure4.png)

透过时间序列下的拓扑结构视图，数据孤岛被弥合起来，大大加快了根因分析的速度。关联起来的数据也易于建议模式，为自动化分析奠定基础。当然，建立这样的数据模型并不容易，除了技术上的挑战，可能还涉及组织上的变革。目前已经有例如 [`OpenTelemetry`](https://opentelemetry.io/) 这类开放标准，尝试先从遥测数据收集的角度建立初步的关联，虽然遥测数据只是第一步，但也是一个良好的开始。



## 可观测性能力建设

### 可观测性关键能力



### 解决方案领导者



### 企业能力建设
